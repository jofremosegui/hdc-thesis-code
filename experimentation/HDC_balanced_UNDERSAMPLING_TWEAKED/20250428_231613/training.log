2025-04-28 23:16:13,233 - INFO - Logging initialized to /Users/jofremosegui/Desktop/TFG/wearbac_experiments/models/data_balancing/results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250428_231613/training.log
2025-04-28 23:16:13,233 - INFO - PRINT: Total configurations: 1
2025-04-28 23:16:36,651 - INFO - PRINT: ==================================================
BEGIN CROSSVALIDATION
==================================================
2025-04-28 23:16:36,651 - INFO - PRINT: 
CONFIG 0: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 10, 'patience': 5, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250428_231613'}

2025-04-28 23:16:36,652 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-28 23:16:36,652 - INFO - PRINT: FOLD: 1
2025-04-28 23:16:36,652 - INFO - PRINT: TRAIN: [9, 10, 14, 15, 24, 28, 31]
2025-04-28 23:16:36,652 - INFO - PRINT: VAL: [11, 6]
2025-04-28 23:16:38,321 - INFO - PRINT: Preparing sequences...
2025-04-28 23:16:39,563 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-28 23:16:44,184 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-28 23:16:47,956 - INFO - PRINT: Undersampled sequence shape: (70055, 800, 7)
2025-04-28 23:16:48,287 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-28 23:16:48,585 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-28 23:16:48,779 - INFO - PRINT: Undersampled sequence shape: (5388, 800, 7)
2025-04-28 23:16:49,362 - INFO - PRINT: Users in train:{9, 10, 14, 15, 24, 28, 31}
2025-04-28 23:16:49,402 - INFO - PRINT: Users in test:{11, 6}
2025-04-28 23:16:49,402 - INFO - PRINT: Number of windows for training:70055
2025-04-28 23:16:49,402 - INFO - PRINT: Number of windows for testing:5388
2025-04-28 23:16:49,638 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-28 23:16:49,638 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-28 23:29:57,888 - INFO - PRINT:     1 | 0.642057 | 0.394407 | 0.5380 | 0.8347 | 763.91
2025-04-28 23:42:07,292 - INFO - PRINT:     2 | 0.675922 | 0.419376 | 0.5101 | 0.8287 | 707.80
2025-04-28 23:54:15,288 - INFO - PRINT:     3 | 0.705314 | 0.437114 | 0.4935 | 0.8248 | 706.29
2025-04-29 00:06:24,639 - INFO - PRINT:     4 | 0.730305 | 0.451988 | 0.4749 | 0.8205 | 707.27
2025-04-29 00:18:33,110 - INFO - PRINT:     5 | 0.749804 | 0.462762 | 0.4638 | 0.8176 | 706.86
2025-04-29 00:30:41,798 - INFO - PRINT:     6 | 0.757351 | 0.469120 | 0.4572 | 0.8159 | 707.10
2025-04-29 00:30:41,798 - INFO - PRINT: 
Early stopping triggered after epoch 6
2025-04-29 00:30:41,798 - INFO - PRINT: Best validation PR-AUC: 0.5380
2025-04-29 00:31:03,438 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-29 00:31:03,439 - INFO - PRINT: FOLD: 2
2025-04-29 00:31:03,439 - INFO - PRINT: TRAIN: [10, 11, 6, 31]
2025-04-29 00:31:03,439 - INFO - PRINT: VAL: [9, 14, 15, 24, 28]
2025-04-29 00:31:11,125 - INFO - PRINT: Preparing sequences...
2025-04-29 00:31:11,467 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-29 00:31:12,822 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-29 00:31:13,685 - INFO - PRINT: Undersampled sequence shape: (17326, 800, 7)
2025-04-29 00:31:14,804 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-29 00:31:19,134 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-29 00:31:22,179 - INFO - PRINT: Undersampled sequence shape: (58117, 800, 7)
2025-04-29 00:31:22,466 - INFO - PRINT: Users in train:{10, 11, 6, 31}
2025-04-29 00:31:22,954 - INFO - PRINT: Users in test:{9, 14, 15, 24, 28}
2025-04-29 00:31:22,955 - INFO - PRINT: Number of windows for training:17326
2025-04-29 00:31:22,955 - INFO - PRINT: Number of windows for testing:58117
2025-04-29 00:31:23,214 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-29 00:31:23,214 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-29 00:39:08,047 - INFO - PRINT:     1 | 0.711155 | 0.509172 | 0.6704 | 0.7561 | 200.28
2025-04-29 00:46:40,153 - INFO - PRINT:     2 | 0.750471 | 0.502810 | 0.6746 | 0.7610 | 205.09
2025-04-29 00:54:13,575 - INFO - PRINT:     3 | 0.770813 | 0.500038 | 0.6766 | 0.7633 | 205.84
2025-04-29 01:01:46,221 - INFO - PRINT:     4 | 0.779204 | 0.499671 | 0.6772 | 0.7640 | 205.28
2025-04-29 01:09:18,148 - INFO - PRINT:     5 | 0.782926 | 0.498910 | 0.6778 | 0.7648 | 204.76
2025-04-29 01:16:51,528 - INFO - PRINT:     6 | 0.788515 | 0.498011 | 0.6785 | 0.7657 | 206.45
2025-04-29 01:24:29,533 - INFO - PRINT:     7 | 0.794116 | 0.498050 | 0.6786 | 0.7658 | 208.89
2025-04-29 01:31:57,781 - INFO - PRINT:     8 | 0.792121 | 0.497662 | 0.6788 | 0.7660 | 203.42
2025-04-29 01:39:28,493 - INFO - PRINT:     9 | 0.797979 | 0.497442 | 0.6791 | 0.7663 | 203.22
2025-04-29 01:47:02,398 - INFO - PRINT:    10 | 0.801459 | 0.497046 | 0.6794 | 0.7668 | 206.84
2025-04-29 01:50:52,778 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-29 01:50:52,781 - INFO - PRINT: FOLD: 3
2025-04-29 01:50:52,781 - INFO - PRINT: TRAIN: [6, 9, 11, 14, 15, 24, 28]
2025-04-29 01:50:52,781 - INFO - PRINT: VAL: [10, 31]
2025-04-29 01:51:01,158 - INFO - PRINT: Preparing sequences...
2025-04-29 01:51:02,370 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-29 01:51:07,173 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-29 01:51:10,513 - INFO - PRINT: Undersampled sequence shape: (63505, 800, 7)
2025-04-29 01:51:10,883 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-29 01:51:11,783 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-29 01:51:12,135 - INFO - PRINT: Undersampled sequence shape: (11938, 800, 7)
2025-04-29 01:51:12,712 - INFO - PRINT: Users in train:{6, 9, 11, 14, 15, 24, 28}
2025-04-29 01:51:12,826 - INFO - PRINT: Users in test:{10, 31}
2025-04-29 01:51:12,826 - INFO - PRINT: Number of windows for training:63505
2025-04-29 01:51:12,826 - INFO - PRINT: Number of windows for testing:11938
2025-04-29 01:51:13,099 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-29 01:51:13,099 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-29 02:03:06,325 - INFO - PRINT:     1 | 0.623856 | 1.677771 | 0.4230 | 0.4156 | 651.97
2025-04-29 02:14:51,076 - INFO - PRINT:     2 | 0.641280 | 1.715991 | 0.4211 | 0.4156 | 648.91
2025-04-29 02:26:38,390 - INFO - PRINT:     3 | 0.651889 | 1.723470 | 0.4211 | 0.4157 | 650.86
2025-04-29 02:38:24,955 - INFO - PRINT:     4 | 0.652496 | 1.729476 | 0.4209 | 0.4156 | 650.68
2025-04-29 02:50:07,729 - INFO - PRINT:     5 | 0.652861 | 1.729786 | 0.4208 | 0.4156 | 649.31
2025-04-29 03:01:51,250 - INFO - PRINT:     6 | 0.655728 | 1.735474 | 0.4206 | 0.4156 | 648.20
2025-04-29 03:01:51,251 - INFO - PRINT: 
Early stopping triggered after epoch 6
2025-04-29 03:01:51,251 - INFO - PRINT: Best validation PR-AUC: 0.4230
2025-04-29 03:02:40,612 - INFO - PRINT: Validation ROC-AUC: 0.4156, PR-AUC: 0.4206, Accuracy: 0.5214, Sober Accuracy: 0.2919, Drunk Accuracy: 0.6976, F1: 0.3464, Threshold: 0.6900
2025-04-29 03:02:40,612 - INFO - PRINT: Updated best config: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 10, 'patience': 5, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250428_231613'}, PR-AUC: 0.4206, Threshold: 0.6900, Epoch: 4.00
2025-04-29 03:02:40,612 - INFO - PRINT: ==================================================
2025-04-29 03:02:40,612 - INFO - PRINT: Final best config: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 4, 'patience': 4, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250428_231613'}, Final best pr_auc: 0.42056714224319636, Final best threshold: 0.6900000000000001, Final best epoch: 4.0
2025-04-29 03:02:40,612 - INFO - PRINT: ==================================================
END CROSSVALIDATION
==================================================
2025-04-29 03:02:43,612 - INFO - PRINT: 
BEGIN TRAIN AND EVALUATION FINAL MODEL

2025-04-29 03:02:48,833 - INFO - PRINT: Preparing sequences...
2025-04-29 03:02:50,293 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-29 03:02:56,154 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-29 03:03:00,258 - INFO - PRINT: Undersampled sequence shape: (75443, 800, 7)
2025-04-29 03:03:00,504 - INFO - PRINT: Starting sequence preparation...
2025-04-29 03:03:00,544 - INFO - PRINT: Processing 7 sessions...
2025-04-29 03:03:00,926 - INFO - PRINT: Created 3958 sequences
2025-04-29 03:03:00,926 - INFO - PRINT: Sequences shape: (3958, 800, 7)
2025-04-29 03:03:01,578 - INFO - PRINT: Users in train:{6, 9, 10, 11, 14, 15, 24, 28, 31}
2025-04-29 03:03:01,629 - INFO - PRINT: Users in test:{16, 25, 26}
2025-04-29 03:03:01,629 - INFO - PRINT: Number of windows for training:75443
2025-04-29 03:03:01,629 - INFO - PRINT: Number of windows for testing:3958
2025-04-29 03:03:01,856 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-29 03:03:01,856 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-29 03:16:06,389 - INFO - PRINT:     1 | 0.633800 | ------ | ------ | 784.53
2025-04-29 03:29:17,684 - INFO - PRINT:     2 | 0.669200 | ------ | ------ | 791.29
2025-04-29 03:42:26,220 - INFO - PRINT:     3 | 0.692097 | ------ | ------ | 788.53
2025-04-29 03:55:35,456 - INFO - PRINT:     4 | 0.703631 | ------ | ------ | 789.23
2025-04-29 04:01:22,879 - INFO - PRINT: Training ROC-AUC: 0.7110, PR-AUC: 0.5967, Accuracy: 0.7454, Sober Accuracy: 0.3643, Drunk Accuracy: 0.9208, F1: 0.4742, Threshold: 0.6900
2025-04-29 04:01:22,883 - INFO - PRINT: Test ROC-AUC: 0.7406, PR-AUC: 0.7330, Accuracy: 0.7769, Sober Accuracy: 0.6122, Drunk Accuracy: 0.8753, F1: 0.6724, Threshold: 0.6900
2025-04-29 04:01:23,125 - INFO - PRINT: Model, predictions, ground truth, and metrics saved in results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250428_231613
2025-04-29 04:01:27,634 - INFO - PRINT: Confusion Matrix:
2025-04-29 04:01:27,635 - INFO - PRINT: [[ 950  590]
 [ 313 2105]]
2025-04-29 04:01:27,654 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x670817800>
2025-04-29 04:01:27,741 - INFO - PRINT: Class counts in TEST set:
2025-04-29 04:01:27,742 - INFO - PRINT: Label 0: 1540
2025-04-29 04:01:27,742 - INFO - PRINT: Label 1: 2418
2025-04-29 04:01:27,742 - INFO - PRINT: 
Class counts in TRAIN set:
2025-04-29 04:01:27,742 - INFO - PRINT: Label 0: 47562
2025-04-29 04:01:27,742 - INFO - PRINT: Label 1: 25831
