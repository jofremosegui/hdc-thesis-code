2025-04-25 11:57:31,324 - INFO - Logging initialized to /Users/jofremosegui/Desktop/TFG/wearbac_experiments/models/data_balancing/results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250425_115731/training.log
2025-04-25 11:57:31,325 - INFO - PRINT: Total configurations: 1
2025-04-25 11:57:55,569 - INFO - PRINT: ==================================================
BEGIN CROSSVALIDATION
==================================================
2025-04-25 11:57:55,572 - INFO - PRINT: 
CONFIG 0: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 10, 'patience': 5, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250425_115731'}

2025-04-25 11:57:55,572 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-25 11:57:55,572 - INFO - PRINT: FOLD: 1
2025-04-25 11:57:55,572 - INFO - PRINT: TRAIN: [9, 10, 14, 15, 24, 28, 31]
2025-04-25 11:57:55,572 - INFO - PRINT: VAL: [11, 6]
2025-04-25 11:57:57,192 - INFO - PRINT: Preparing sequences...
2025-04-25 11:57:58,488 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-25 11:58:03,155 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-25 11:58:06,842 - INFO - PRINT: Undersampled sequence shape: (69436, 800, 7)
2025-04-25 11:58:07,077 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-25 11:58:07,376 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-25 11:58:07,473 - INFO - PRINT: Undersampled sequence shape: (3704, 800, 7)
2025-04-25 11:58:08,078 - INFO - PRINT: Users in train:{9, 10, 14, 15, 24, 28, 31}
2025-04-25 11:58:08,118 - INFO - PRINT: Users in test:{11, 6}
2025-04-25 11:58:08,119 - INFO - PRINT: Number of windows for training:69436
2025-04-25 11:58:08,119 - INFO - PRINT: Number of windows for testing:3704
2025-04-25 11:58:09,034 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-25 11:58:09,034 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-25 12:11:52,638 - INFO - PRINT:     1 | 1.046951 | 1.019391 | 0.8643 | 0.8293 | 804.60
2025-04-25 12:25:07,931 - INFO - PRINT:     2 | 1.023118 | 1.010812 | 0.8644 | 0.8297 | 735.95
2025-04-25 12:37:48,693 - INFO - PRINT:     3 | 1.036197 | 1.023040 | 0.8639 | 0.8289 | 732.60
2025-04-25 12:50:59,145 - INFO - PRINT:     4 | 1.032307 | 1.013741 | 0.8642 | 0.8293 | 738.84
2025-04-25 13:03:51,850 - INFO - PRINT:     5 | 1.020888 | 1.008351 | 0.8643 | 0.8296 | 747.97
2025-04-25 13:16:40,677 - INFO - PRINT:     6 | 1.030070 | 1.013062 | 0.8640 | 0.8292 | 736.88
2025-04-25 13:29:29,157 - INFO - PRINT:     7 | 1.017346 | 1.002078 | 0.8647 | 0.8303 | 739.68
2025-04-25 13:42:45,644 - INFO - PRINT:     8 | 1.012246 | 0.994764 | 0.8648 | 0.8306 | 739.38
2025-04-25 13:55:39,113 - INFO - PRINT:     9 | 1.010772 | 0.993793 | 0.8649 | 0.8307 | 747.99
2025-04-25 14:08:30,625 - INFO - PRINT:    10 | 1.008301 | 0.990253 | 0.8649 | 0.8307 | 739.70
2025-04-25 14:08:48,038 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-25 14:08:48,038 - INFO - PRINT: FOLD: 2
2025-04-25 14:08:48,038 - INFO - PRINT: TRAIN: [10, 11, 6, 31]
2025-04-25 14:08:48,038 - INFO - PRINT: VAL: [9, 14, 15, 24, 28]
2025-04-25 14:08:55,503 - INFO - PRINT: Preparing sequences...
2025-04-25 14:08:55,832 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-25 14:08:57,170 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-25 14:08:58,081 - INFO - PRINT: Undersampled sequence shape: (17705, 800, 7)
2025-04-25 14:08:59,223 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-25 14:09:03,590 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-25 14:09:06,308 - INFO - PRINT: Undersampled sequence shape: (55688, 800, 7)
2025-04-25 14:09:06,593 - INFO - PRINT: Users in train:{10, 11, 6, 31}
2025-04-25 14:09:07,077 - INFO - PRINT: Users in test:{9, 14, 15, 24, 28}
2025-04-25 14:09:07,077 - INFO - PRINT: Number of windows for training:17705
2025-04-25 14:09:07,077 - INFO - PRINT: Number of windows for testing:55688
2025-04-25 14:09:07,343 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-25 14:09:07,343 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-25 14:16:37,911 - INFO - PRINT:     1 | 0.825693 | 0.581470 | 0.5734 | 0.7592 | 211.33
2025-04-25 14:23:56,199 - INFO - PRINT:     2 | 0.842738 | 0.582722 | 0.5736 | 0.7594 | 194.66
2025-04-25 15:09:25,316 - INFO - PRINT:     3 | 0.869489 | 0.587748 | 0.5799 | 0.7621 | 1964.49
2025-04-25 15:17:28,101 - INFO - PRINT:     4 | 0.879475 | 0.588258 | 0.5815 | 0.7627 | 227.56
2025-04-25 15:31:52,058 - INFO - PRINT:     5 | 0.872236 | 0.587354 | 0.5809 | 0.7625 | 196.10
2025-04-25 15:38:57,418 - INFO - PRINT:     6 | 0.874282 | 0.586130 | 0.5799 | 0.7621 | 197.89
2025-04-25 15:46:07,443 - INFO - PRINT:     7 | 0.871010 | 0.586049 | 0.5800 | 0.7621 | 194.69
2025-04-25 15:53:16,736 - INFO - PRINT:     8 | 0.872996 | 0.586101 | 0.5802 | 0.7622 | 193.80
2025-04-25 16:00:22,167 - INFO - PRINT:     9 | 0.875940 | 0.587679 | 0.5813 | 0.7627 | 198.43
2025-04-25 16:00:22,169 - INFO - PRINT: 
Early stopping triggered after epoch 9
2025-04-25 16:00:22,169 - INFO - PRINT: Best validation PR-AUC: 0.5815
2025-04-25 16:04:06,597 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-25 16:04:06,598 - INFO - PRINT: FOLD: 3
2025-04-25 16:04:06,598 - INFO - PRINT: TRAIN: [6, 9, 11, 14, 15, 24, 28]
2025-04-25 16:04:06,598 - INFO - PRINT: VAL: [10, 31]
2025-04-25 16:04:14,702 - INFO - PRINT: Preparing sequences...
2025-04-25 16:04:15,858 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-25 16:04:20,556 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-25 16:04:23,392 - INFO - PRINT: Undersampled sequence shape: (59645, 800, 7)
2025-04-25 16:04:23,736 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-25 16:04:24,648 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-25 16:04:25,129 - INFO - PRINT: Undersampled sequence shape: (13748, 800, 7)
2025-04-25 16:04:25,700 - INFO - PRINT: Users in train:{6, 9, 11, 14, 15, 24, 28}
2025-04-25 16:04:25,811 - INFO - PRINT: Users in test:{10, 31}
2025-04-25 16:04:25,811 - INFO - PRINT: Number of windows for training:59645
2025-04-25 16:04:25,811 - INFO - PRINT: Number of windows for testing:13748
2025-04-25 16:04:26,092 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-25 16:04:26,092 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-25 16:17:43,123 - INFO - PRINT:     1 | 0.989657 | 1.925684 | 0.2200 | 0.4158 | 647.21
2025-04-25 16:29:18,352 - INFO - PRINT:     2 | 1.015655 | 1.939273 | 0.2203 | 0.4159 | 633.59
2025-04-25 16:40:53,793 - INFO - PRINT:     3 | 1.025744 | 1.955133 | 0.2206 | 0.4160 | 630.31
2025-04-25 16:52:35,492 - INFO - PRINT:     4 | 1.030161 | 1.957156 | 0.2206 | 0.4160 | 636.10
2025-04-25 17:04:15,823 - INFO - PRINT:     5 | 1.032165 | 1.959307 | 0.2206 | 0.4161 | 634.45
2025-04-25 17:15:54,261 - INFO - PRINT:     6 | 1.034870 | 1.963133 | 0.2207 | 0.4160 | 633.85
2025-04-25 17:27:33,543 - INFO - PRINT:     7 | 1.035493 | 1.967091 | 0.2207 | 0.4160 | 632.74
2025-04-25 17:40:34,792 - INFO - PRINT:     8 | 1.040636 | 1.973451 | 0.2207 | 0.4160 | 633.73
2025-04-25 17:52:39,663 - INFO - PRINT:     9 | 1.033279 | 1.965346 | 0.2206 | 0.4161 | 662.06
2025-04-25 18:04:40,952 - INFO - PRINT:    10 | 1.036983 | 1.967878 | 0.2207 | 0.4161 | 652.90
2025-04-25 18:05:43,992 - INFO - PRINT: Validation ROC-AUC: 0.4161, PR-AUC: 0.2207, Accuracy: 0.7588, Sober Accuracy: 0.0397, Drunk Accuracy: 0.9929, F1: 0.0748, Threshold: 0.9900
2025-04-25 18:05:43,992 - INFO - PRINT: Updated best config: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 10, 'patience': 5, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250425_115731'}, PR-AUC: 0.2207, Threshold: 0.9900, Epoch: 8.00
2025-04-25 18:05:43,993 - INFO - PRINT: ==================================================
2025-04-25 18:05:43,993 - INFO - PRINT: Final best config: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 8, 'patience': 8, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250425_115731'}, Final best pr_auc: 0.22068441875237615, Final best threshold: 0.99, Final best epoch: 8.0
2025-04-25 18:05:43,993 - INFO - PRINT: ==================================================
END CROSSVALIDATION
==================================================
2025-04-25 18:05:47,189 - INFO - PRINT: 
BEGIN TRAIN AND EVALUATION FINAL MODEL

2025-04-25 18:05:52,541 - INFO - PRINT: Preparing sequences...
2025-04-25 18:05:54,025 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-25 18:06:00,126 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-25 18:06:03,868 - INFO - PRINT: Undersampled sequence shape: (73393, 800, 7)
2025-04-25 18:06:04,086 - INFO - PRINT: Starting sequence preparation...
2025-04-25 18:06:04,126 - INFO - PRINT: Processing 7 sessions...
2025-04-25 18:06:04,513 - INFO - PRINT: Created 3958 sequences
2025-04-25 18:06:04,513 - INFO - PRINT: Sequences shape: (3958, 800, 7)
2025-04-25 18:06:05,169 - INFO - PRINT: Users in train:{6, 9, 10, 11, 14, 15, 24, 28, 31}
2025-04-25 18:06:05,221 - INFO - PRINT: Users in test:{16, 25, 26}
2025-04-25 18:06:05,221 - INFO - PRINT: Number of windows for training:73393
2025-04-25 18:06:05,222 - INFO - PRINT: Number of windows for testing:3958
2025-04-25 18:06:05,469 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-25 18:06:05,469 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-25 18:20:00,849 - INFO - PRINT:     1 | 1.096843 | ------ | ------ | 835.38
2025-04-25 18:33:18,172 - INFO - PRINT:     2 | 1.107984 | ------ | ------ | 797.32
2025-04-25 18:49:25,349 - INFO - PRINT:     3 | 1.113328 | ------ | ------ | 967.17
2025-04-25 19:02:32,524 - INFO - PRINT:     4 | 1.106971 | ------ | ------ | 787.17
2025-04-25 19:15:32,996 - INFO - PRINT:     5 | 1.103102 | ------ | ------ | 780.47
2025-04-25 19:28:34,781 - INFO - PRINT:     6 | 1.097382 | ------ | ------ | 781.78
2025-04-25 19:41:37,688 - INFO - PRINT:     7 | 1.097129 | ------ | ------ | 782.91
2025-04-25 19:54:38,461 - INFO - PRINT:     8 | 1.095024 | ------ | ------ | 780.77
2025-04-25 20:00:02,203 - INFO - PRINT: Training ROC-AUC: 0.7123, PR-AUC: 0.5508, Accuracy: 0.6575, Sober Accuracy: 0.0275, Drunk Accuracy: 0.9997, F1: 0.0535, Threshold: 0.9900
2025-04-25 20:00:02,206 - INFO - PRINT: Test ROC-AUC: 0.7391, PR-AUC: 0.7618, Accuracy: 0.3891, Sober Accuracy: 0.0000, Drunk Accuracy: 1.0000, F1: 0.0000, Threshold: 0.9900
2025-04-25 20:00:02,328 - INFO - PRINT: Model, predictions, ground truth, and metrics saved in results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250425_115731
2025-04-25 20:00:06,624 - INFO - PRINT: Confusion Matrix:
2025-04-25 20:00:06,625 - INFO - PRINT: [[ 950  590]
 [ 313 2105]]
2025-04-25 20:00:06,644 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x6adc26f60>
2025-04-25 20:00:06,730 - INFO - PRINT: Class counts in TEST set:
2025-04-25 20:00:06,730 - INFO - PRINT: Label 0: 1540
2025-04-25 20:00:06,730 - INFO - PRINT: Label 1: 2418
2025-04-25 20:00:06,730 - INFO - PRINT: 
Class counts in TRAIN set:
2025-04-25 20:00:06,730 - INFO - PRINT: Label 0: 47562
2025-04-25 20:00:06,731 - INFO - PRINT: Label 1: 25831
2025-04-25 23:03:21,264 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/__init__.py
2025-04-25 23:03:21,264 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/embeddings.py
2025-04-25 23:03:21,264 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/models.py
2025-04-25 23:03:21,279 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/__init__.py
