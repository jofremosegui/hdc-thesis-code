2025-04-22 20:24:24,049 - INFO - Logging initialized to /Users/jofremosegui/Desktop/TFG/wearbac_experiments/models/data_balancing/results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250422_202424/training.log
2025-04-22 20:24:24,050 - INFO - PRINT: Total configurations: 1
2025-04-22 20:24:44,992 - INFO - PRINT: ==================================================
BEGIN CROSSVALIDATION
==================================================
2025-04-22 20:24:44,993 - INFO - PRINT: 
CONFIG 0: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 10, 'patience': 5, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250422_202424'}

2025-04-22 20:24:44,993 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-22 20:24:45,050 - INFO - PRINT: FOLD: 1
2025-04-22 20:24:45,050 - INFO - PRINT: TRAIN: [9, 10, 14, 15, 24, 28, 31]
2025-04-22 20:24:45,050 - INFO - PRINT: VAL: [11, 6]
2025-04-22 20:24:46,147 - INFO - PRINT: Preparing sequences...
2025-04-22 20:24:47,432 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-22 20:24:52,031 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-22 20:24:54,746 - INFO - PRINT: Undersampled sequence shape: (70055, 800, 7)
2025-04-22 20:24:54,916 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-22 20:24:55,241 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-22 20:24:55,481 - INFO - PRINT: Undersampled sequence shape: (5388, 800, 7)
2025-04-22 20:24:56,078 - INFO - PRINT: Users in train:{9, 10, 14, 15, 24, 28, 31}
2025-04-22 20:24:56,118 - INFO - PRINT: Users in test:{11, 6}
2025-04-22 20:24:56,118 - INFO - PRINT: Number of windows for training:70055
2025-04-22 20:24:56,118 - INFO - PRINT: Number of windows for testing:5388
2025-04-22 20:24:56,358 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-22 20:24:56,358 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-22 20:36:52,691 - INFO - PRINT:     1 | 0.686026 | 0.428246 | 0.9621 | 0.8263 | 691.88
2025-04-22 20:48:43,267 - INFO - PRINT:     2 | 0.721215 | 0.449146 | 0.9612 | 0.8218 | 689.33
2025-04-22 21:00:33,918 - INFO - PRINT:     3 | 0.747338 | 0.464163 | 0.9604 | 0.8175 | 689.39
2025-04-22 21:12:23,930 - INFO - PRINT:     4 | 0.767031 | 0.475338 | 0.9597 | 0.8140 | 688.66
2025-04-22 21:24:13,716 - INFO - PRINT:     5 | 0.782435 | 0.483414 | 0.9592 | 0.8114 | 688.68
2025-04-22 21:36:02,730 - INFO - PRINT:     6 | 0.787260 | 0.487711 | 0.9590 | 0.8104 | 687.97
2025-04-22 21:36:02,731 - INFO - PRINT: 
Early stopping triggered after epoch 6
2025-04-22 21:36:02,731 - INFO - PRINT: Best validation PR-AUC: 0.9621
2025-04-22 21:36:23,857 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-22 21:36:23,857 - INFO - PRINT: FOLD: 2
2025-04-22 21:36:23,858 - INFO - PRINT: TRAIN: [10, 11, 6, 31]
2025-04-22 21:36:23,858 - INFO - PRINT: VAL: [9, 14, 15, 24, 28]
2025-04-22 21:36:28,579 - INFO - PRINT: Preparing sequences...
2025-04-22 21:36:28,913 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-22 21:36:30,214 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-22 21:36:31,083 - INFO - PRINT: Undersampled sequence shape: (17326, 800, 7)
2025-04-22 21:36:32,190 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-22 21:36:36,567 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-22 21:36:39,648 - INFO - PRINT: Undersampled sequence shape: (58117, 800, 7)
2025-04-22 21:36:39,882 - INFO - PRINT: Users in train:{10, 11, 6, 31}
2025-04-22 21:36:40,376 - INFO - PRINT: Users in test:{9, 14, 15, 24, 28}
2025-04-22 21:36:40,377 - INFO - PRINT: Number of windows for training:17326
2025-04-22 21:36:40,377 - INFO - PRINT: Number of windows for testing:58117
2025-04-22 21:36:40,770 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-22 21:36:40,770 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-22 21:43:26,173 - INFO - PRINT:     1 | 0.749181 | 0.496427 | 0.8457 | 0.7645 | 178.86
2025-04-22 21:50:10,680 - INFO - PRINT:     2 | 0.785006 | 0.497299 | 0.8468 | 0.7656 | 179.27
2025-04-22 21:56:56,655 - INFO - PRINT:     3 | 0.795992 | 0.496780 | 0.8475 | 0.7662 | 178.27
2025-04-22 22:03:43,776 - INFO - PRINT:     4 | 0.798584 | 0.497439 | 0.8474 | 0.7662 | 178.37
2025-04-22 22:10:30,123 - INFO - PRINT:     5 | 0.798689 | 0.497078 | 0.8478 | 0.7665 | 178.60
2025-04-22 22:17:15,768 - INFO - PRINT:     6 | 0.801946 | 0.496669 | 0.8484 | 0.7669 | 178.52
2025-04-22 22:24:01,774 - INFO - PRINT:     7 | 0.806650 | 0.496842 | 0.8483 | 0.7669 | 178.32
2025-04-22 22:30:48,216 - INFO - PRINT:     8 | 0.803249 | 0.496696 | 0.8482 | 0.7669 | 178.70
2025-04-22 22:37:27,500 - INFO - PRINT:     9 | 0.807899 | 0.496714 | 0.8486 | 0.7671 | 179.43
2025-04-22 22:44:07,266 - INFO - PRINT:    10 | 0.809840 | 0.496683 | 0.8489 | 0.7673 | 178.34
2025-04-22 22:47:49,846 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-22 22:47:49,847 - INFO - PRINT: FOLD: 3
2025-04-22 22:47:49,847 - INFO - PRINT: TRAIN: [6, 9, 11, 14, 15, 24, 28]
2025-04-22 22:47:49,847 - INFO - PRINT: VAL: [10, 31]
2025-04-22 22:47:54,888 - INFO - PRINT: Preparing sequences...
2025-04-22 22:47:56,030 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-22 22:48:00,689 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-22 22:48:04,404 - INFO - PRINT: Undersampled sequence shape: (63505, 800, 7)
2025-04-22 22:48:04,808 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-22 22:48:05,718 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-22 22:48:06,075 - INFO - PRINT: Undersampled sequence shape: (11938, 800, 7)
2025-04-22 22:48:06,631 - INFO - PRINT: Users in train:{6, 9, 11, 14, 15, 24, 28}
2025-04-22 22:48:06,743 - INFO - PRINT: Users in test:{10, 31}
2025-04-22 22:48:06,743 - INFO - PRINT: Number of windows for training:63505
2025-04-22 22:48:06,743 - INFO - PRINT: Number of windows for testing:11938
2025-04-22 22:48:07,083 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-22 22:48:07,083 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-22 22:59:41,418 - INFO - PRINT:     1 | 0.524513 | 1.455860 | 0.5131 | 0.4157 | 638.98
2025-04-22 23:10:56,571 - INFO - PRINT:     2 | 0.562780 | 1.548963 | 0.5131 | 0.4159 | 626.93
2025-04-22 23:22:10,822 - INFO - PRINT:     3 | 0.591088 | 1.594441 | 0.5131 | 0.4160 | 626.13
2025-04-22 23:33:26,483 - INFO - PRINT:     4 | 0.602375 | 1.623927 | 0.5133 | 0.4160 | 626.65
2025-04-22 23:44:40,141 - INFO - PRINT:     5 | 0.609990 | 1.637411 | 0.5135 | 0.4159 | 625.34
2025-04-22 23:55:52,748 - INFO - PRINT:     6 | 0.619906 | 1.658040 | 0.5135 | 0.4158 | 623.77
2025-04-23 00:07:04,430 - INFO - PRINT:     7 | 0.624108 | 1.664852 | 0.5136 | 0.4158 | 623.27
2025-04-23 00:18:17,532 - INFO - PRINT:     8 | 0.627194 | 1.672361 | 0.5136 | 0.4157 | 624.53
2025-04-23 00:29:29,578 - INFO - PRINT:     9 | 0.629854 | 1.677824 | 0.5137 | 0.4157 | 623.88
2025-04-23 00:40:42,093 - INFO - PRINT:    10 | 0.631874 | 1.681012 | 0.5138 | 0.4157 | 624.18
2025-04-23 00:41:28,371 - INFO - PRINT: Validation ROC-AUC: 0.4157, PR-AUC: 0.5138, Accuracy: 0.5222, Sober Accuracy: 0.7002, Drunk Accuracy: 0.2904, F1: 0.6237, Threshold: 0.3100
2025-04-23 00:41:28,372 - INFO - PRINT: Updated best config: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 10, 'patience': 5, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250422_202424'}, PR-AUC: 0.5138, Threshold: 0.3100, Epoch: 7.00
2025-04-23 00:41:28,372 - INFO - PRINT: ==================================================
2025-04-23 00:41:28,372 - INFO - PRINT: Final best config: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 7, 'patience': 7, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250422_202424'}, Final best pr_auc: 0.5137741550221363, Final best threshold: 0.31, Final best epoch: 7.0
2025-04-23 00:41:28,372 - INFO - PRINT: ==================================================
END CROSSVALIDATION
==================================================
2025-04-23 00:41:31,126 - INFO - PRINT: 
BEGIN TRAIN AND EVALUATION FINAL MODEL

2025-04-23 00:41:35,677 - INFO - PRINT: Preparing sequences...
2025-04-23 00:41:37,088 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-23 00:41:43,240 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-23 00:41:47,252 - INFO - PRINT: Undersampled sequence shape: (75443, 800, 7)
2025-04-23 01:12:07,496 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/__init__.py
2025-04-23 01:12:07,496 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/embeddings.py
2025-04-23 01:12:07,496 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/models.py
2025-04-23 01:12:07,505 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/__init__.py
