2025-04-18 10:08:39,481 - INFO - Logging initialized to /Users/jofremosegui/Desktop/TFG/wearbac_experiments/models/data_balancing/results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250418_100839/training.log
2025-04-18 10:08:39,481 - INFO - PRINT: Total configurations: 1
2025-04-18 10:09:03,589 - INFO - PRINT: ==================================================
BEGIN CROSSVALIDATION
==================================================
2025-04-18 10:09:03,589 - INFO - PRINT: 
CONFIG 0: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 10, 'patience': 5, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250418_100839'}

2025-04-18 10:09:03,589 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-18 10:09:03,589 - INFO - PRINT: FOLD: 1
2025-04-18 10:09:03,589 - INFO - PRINT: TRAIN: [9, 10, 14, 15, 24, 28, 31]
2025-04-18 10:09:03,589 - INFO - PRINT: VAL: [11, 6]
2025-04-18 10:09:05,183 - INFO - PRINT: Preparing sequences...
2025-04-18 10:09:06,424 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-18 10:09:11,097 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-18 10:09:14,822 - INFO - PRINT: Undersampled sequence shape: (70055, 800, 7)
2025-04-18 10:09:15,046 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-18 10:09:15,350 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-18 10:09:15,543 - INFO - PRINT: Undersampled sequence shape: (5388, 800, 7)
2025-04-18 10:09:16,149 - INFO - PRINT: Users in train:{9, 10, 14, 15, 24, 28, 31}
2025-04-18 10:09:16,189 - INFO - PRINT: Users in test:{11, 6}
2025-04-18 10:09:16,190 - INFO - PRINT: Number of windows for training:70055
2025-04-18 10:09:16,190 - INFO - PRINT: Number of windows for testing:5388
2025-04-18 10:09:16,425 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-18 10:09:16,425 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-18 10:22:15,270 - INFO - PRINT:     1 | 0.686026 | 0.428246 | 0.9621 | 0.8263 | 750.00
2025-04-18 10:34:36,714 - INFO - PRINT:     2 | 0.721215 | 0.449146 | 0.9612 | 0.8218 | 715.84
2025-04-18 10:47:28,116 - INFO - PRINT:     3 | 0.747338 | 0.464163 | 0.9604 | 0.8175 | 746.27
2025-04-18 11:25:56,648 - INFO - PRINT:     4 | 0.767031 | 0.475338 | 0.9597 | 0.8140 | 2283.28
2025-04-18 12:05:52,738 - INFO - PRINT:     5 | 0.782435 | 0.483414 | 0.9592 | 0.8114 | 2370.17
2025-04-18 12:18:19,720 - INFO - PRINT:     6 | 0.787260 | 0.487711 | 0.9590 | 0.8104 | 720.55
2025-04-18 12:18:19,722 - INFO - PRINT: 
Early stopping triggered after epoch 6
2025-04-18 12:18:19,722 - INFO - PRINT: Best validation PR-AUC: 0.9621
2025-04-18 12:18:43,096 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-18 12:18:43,096 - INFO - PRINT: FOLD: 2
2025-04-18 12:18:43,096 - INFO - PRINT: TRAIN: [10, 11, 6, 31]
2025-04-18 12:18:43,096 - INFO - PRINT: VAL: [9, 14, 15, 24, 28]
2025-04-18 12:18:50,940 - INFO - PRINT: Preparing sequences...
2025-04-18 12:18:51,263 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-18 12:18:52,616 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-18 12:18:53,533 - INFO - PRINT: Undersampled sequence shape: (17326, 800, 7)
2025-04-18 12:18:54,633 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-18 12:18:59,085 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-18 12:19:02,016 - INFO - PRINT: Undersampled sequence shape: (58117, 800, 7)
2025-04-18 12:19:02,271 - INFO - PRINT: Users in train:{10, 11, 6, 31}
2025-04-18 12:19:02,765 - INFO - PRINT: Users in test:{9, 14, 15, 24, 28}
2025-04-18 12:19:02,766 - INFO - PRINT: Number of windows for training:17326
2025-04-18 12:19:02,766 - INFO - PRINT: Number of windows for testing:58117
2025-04-18 12:19:03,033 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-18 12:19:03,033 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-18 12:25:50,551 - INFO - PRINT:     1 | 0.749181 | 0.496427 | 0.8457 | 0.7645 | 180.94
2025-04-18 12:32:36,181 - INFO - PRINT:     2 | 0.785006 | 0.497299 | 0.8468 | 0.7656 | 180.98
2025-04-18 12:39:20,788 - INFO - PRINT:     3 | 0.795992 | 0.496780 | 0.8475 | 0.7662 | 180.85
2025-04-18 12:46:05,117 - INFO - PRINT:     4 | 0.798584 | 0.497439 | 0.8474 | 0.7662 | 180.67
2025-04-18 12:52:49,713 - INFO - PRINT:     5 | 0.798689 | 0.497078 | 0.8478 | 0.7665 | 180.91
2025-04-18 12:59:33,920 - INFO - PRINT:     6 | 0.801946 | 0.496669 | 0.8484 | 0.7669 | 180.53
2025-04-18 13:06:18,436 - INFO - PRINT:     7 | 0.806650 | 0.496842 | 0.8483 | 0.7669 | 180.71
2025-04-18 13:13:02,076 - INFO - PRINT:     8 | 0.803249 | 0.496696 | 0.8482 | 0.7669 | 179.99
2025-04-18 13:19:47,266 - INFO - PRINT:     9 | 0.807899 | 0.496714 | 0.8486 | 0.7671 | 180.79
2025-04-18 13:26:31,876 - INFO - PRINT:    10 | 0.809840 | 0.496683 | 0.8489 | 0.7673 | 180.93
2025-04-18 13:30:15,303 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-18 13:30:15,304 - INFO - PRINT: FOLD: 3
2025-04-18 13:30:15,304 - INFO - PRINT: TRAIN: [6, 9, 11, 14, 15, 24, 28]
2025-04-18 13:30:15,304 - INFO - PRINT: VAL: [10, 31]
2025-04-18 13:30:18,208 - INFO - PRINT: Preparing sequences...
2025-04-18 13:30:19,339 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-18 13:30:23,976 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-18 13:30:27,521 - INFO - PRINT: Undersampled sequence shape: (63505, 800, 7)
2025-04-18 13:30:27,870 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-18 13:30:28,790 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-18 13:30:29,140 - INFO - PRINT: Undersampled sequence shape: (11938, 800, 7)
2025-04-18 13:30:29,708 - INFO - PRINT: Users in train:{6, 9, 11, 14, 15, 24, 28}
2025-04-18 13:30:29,816 - INFO - PRINT: Users in test:{10, 31}
2025-04-18 13:30:29,816 - INFO - PRINT: Number of windows for training:63505
2025-04-18 13:30:29,816 - INFO - PRINT: Number of windows for testing:11938
2025-04-18 13:30:30,180 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-18 13:30:30,181 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-18 13:42:18,337 - INFO - PRINT:     1 | 0.524513 | 1.455860 | 0.5131 | 0.4157 | 645.91
2025-04-18 13:53:57,965 - INFO - PRINT:     2 | 0.562780 | 1.548963 | 0.5131 | 0.4159 | 646.09
2025-04-18 14:05:35,119 - INFO - PRINT:     3 | 0.591088 | 1.594441 | 0.5131 | 0.4160 | 642.57
2025-04-18 14:16:59,377 - INFO - PRINT:     4 | 0.602375 | 1.623927 | 0.5133 | 0.4160 | 630.80
2025-04-18 14:28:19,349 - INFO - PRINT:     5 | 0.609990 | 1.637411 | 0.5135 | 0.4159 | 626.70
2025-04-18 14:39:40,870 - INFO - PRINT:     6 | 0.619906 | 1.658040 | 0.5135 | 0.4158 | 627.47
2025-04-18 14:51:02,885 - INFO - PRINT:     7 | 0.624108 | 1.664852 | 0.5136 | 0.4158 | 628.80
2025-04-18 15:02:23,713 - INFO - PRINT:     8 | 0.627194 | 1.672361 | 0.5136 | 0.4157 | 628.29
2025-04-18 15:13:52,992 - INFO - PRINT:     9 | 0.629854 | 1.677824 | 0.5137 | 0.4157 | 635.04
2025-04-18 15:25:26,101 - INFO - PRINT:    10 | 0.631874 | 1.681012 | 0.5138 | 0.4157 | 639.46
2025-04-18 15:26:17,227 - INFO - PRINT: Validation ROC-AUC: 0.4157, PR-AUC: 0.5138, Accuracy: 0.5222, Sober Accuracy: 0.2904, Drunk Accuracy: 0.7002, F1: 0.6237, Threshold: 0.3100
2025-04-18 15:26:17,227 - INFO - PRINT: Updated best config: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 10, 'patience': 5, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250418_100839'}, PR-AUC: 0.5138, Threshold: 0.3100, Epoch: 7.00
2025-04-18 15:26:17,228 - INFO - PRINT: ==================================================
2025-04-18 15:26:17,228 - INFO - PRINT: Final best config: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 7, 'patience': 7, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250418_100839'}, Final best pr_auc: 0.5137741550221363, Final best threshold: 0.31, Final best epoch: 7.0
2025-04-18 15:26:17,228 - INFO - PRINT: ==================================================
END CROSSVALIDATION
==================================================
2025-04-18 15:26:20,144 - INFO - PRINT: 
BEGIN TRAIN AND EVALUATION FINAL MODEL

2025-04-18 15:26:25,176 - INFO - PRINT: Preparing sequences...
2025-04-18 15:26:26,583 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-18 15:26:32,586 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-18 15:26:36,609 - INFO - PRINT: Undersampled sequence shape: (75443, 800, 7)
2025-04-18 15:26:36,837 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-18 15:26:37,263 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-18 15:26:37,491 - INFO - PRINT: Undersampled sequence shape: (6376, 800, 7)
2025-04-18 15:26:38,152 - INFO - PRINT: Users in train:{6, 9, 10, 11, 14, 15, 24, 28, 31}
2025-04-18 15:26:38,202 - INFO - PRINT: Users in test:{16, 25, 26}
2025-04-18 15:26:38,202 - INFO - PRINT: Number of windows for training:75443
2025-04-18 15:26:38,202 - INFO - PRINT: Number of windows for testing:6376
2025-04-18 15:26:38,443 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-18 15:26:38,443 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-18 15:39:49,351 - INFO - PRINT:     1 | 0.586064 | ------ | ------ | 790.91
2025-04-18 15:52:42,285 - INFO - PRINT:     2 | 0.625088 | ------ | ------ | 772.93
2025-04-18 16:05:36,646 - INFO - PRINT:     3 | 0.650294 | ------ | ------ | 774.36
2025-04-18 16:18:32,369 - INFO - PRINT:     4 | 0.668975 | ------ | ------ | 775.72
2025-04-18 16:31:29,205 - INFO - PRINT:     5 | 0.686249 | ------ | ------ | 776.83
2025-04-18 16:44:31,821 - INFO - PRINT:     6 | 0.695884 | ------ | ------ | 782.61
2025-04-18 16:57:28,451 - INFO - PRINT:     7 | 0.704972 | ------ | ------ | 776.63
2025-04-18 17:03:02,953 - INFO - PRINT: Training ROC-AUC: 0.7109, PR-AUC: 0.8198, Accuracy: 0.7455, Sober Accuracy: 0.3639, Drunk Accuracy: 0.9211, F1: 0.8321, Threshold: 0.3100
2025-04-18 17:03:02,957 - INFO - PRINT: Test ROC-AUC: 0.7404, PR-AUC: 0.8647, Accuracy: 0.8179, Sober Accuracy: 0.6071, Drunk Accuracy: 0.8850, F1: 0.8806, Threshold: 0.3100
2025-04-18 17:03:03,069 - INFO - PRINT: Model, predictions, ground truth, and metrics saved in results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250418_100839
2025-04-18 17:03:06,688 - INFO - PRINT: Confusion Matrix:
2025-04-18 17:03:06,692 - INFO - PRINT: [[ 474  988]
 [ 127 4865]]
2025-04-18 17:03:06,712 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x62bb8f4d0>
2025-04-18 18:46:17,221 - INFO - PRINT: Confusion Matrix:
2025-04-18 18:46:17,222 - INFO - PRINT: [[ 611  929]
 [ 114 4722]]
2025-04-18 18:46:17,232 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x44215a900>
2025-04-18 21:39:01,165 - INFO - PRINT: Idx | Prob | Pred_Label | True_Label
2025-04-18 21:39:01,165 - INFO - PRINT: -----------------------------------
2025-04-18 21:39:01,165 - INFO - PRINT:   0 | 0.950 | 1          | 1
2025-04-18 21:39:01,165 - INFO - PRINT:   1 | 0.560 | 1          | 1
2025-04-18 21:39:01,165 - INFO - PRINT:   2 | 0.822 | 1          | 1
2025-04-18 21:39:01,166 - INFO - PRINT:   3 | 0.559 | 1          | 1
2025-04-18 21:39:01,166 - INFO - PRINT:   4 | 0.024 | 0          | 0
2025-04-18 21:41:18,425 - INFO - PRINT: Class counts in TEST set:
2025-04-18 21:41:18,425 - INFO - PRINT: Label 0: 1540
2025-04-18 21:41:18,425 - INFO - PRINT: Label 1: 4836
2025-04-18 21:41:18,426 - INFO - PRINT: 
Class counts in TRAIN set:
2025-04-18 21:41:18,426 - INFO - PRINT: Label 0: 23781
2025-04-18 21:41:18,426 - INFO - PRINT: Label 1: 51662
2025-04-18 21:41:31,856 - INFO - PRINT: Class counts in TEST set:
2025-04-18 21:41:31,856 - INFO - PRINT: Label 0: 1540
2025-04-18 21:41:31,856 - INFO - PRINT: Label 1: 4836
2025-04-18 21:41:31,856 - INFO - PRINT: 
Class counts in TRAIN set:
2025-04-18 21:41:31,857 - INFO - PRINT: Label 0: 23781
2025-04-18 21:41:31,857 - INFO - PRINT: Label 1: 51662
2025-04-20 13:29:03,678 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/__init__.py
2025-04-20 13:29:03,678 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/embeddings.py
2025-04-20 13:29:03,678 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/models.py
2025-04-20 13:29:03,703 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/__init__.py
