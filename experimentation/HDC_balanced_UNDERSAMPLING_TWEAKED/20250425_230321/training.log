2025-04-25 23:03:21,386 - INFO - Logging initialized to /Users/jofremosegui/Desktop/TFG/wearbac_experiments/models/data_balancing/results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250425_230321/training.log
2025-04-25 23:03:21,386 - INFO - PRINT: Total configurations: 1
2025-04-25 23:03:45,749 - INFO - PRINT: ==================================================
BEGIN CROSSVALIDATION
==================================================
2025-04-25 23:03:45,750 - INFO - PRINT: 
CONFIG 0: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 10, 'patience': 5, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250425_230321'}

2025-04-25 23:03:45,751 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-25 23:03:45,751 - INFO - PRINT: FOLD: 1
2025-04-25 23:03:45,751 - INFO - PRINT: TRAIN: [9, 10, 14, 15, 24, 28, 31]
2025-04-25 23:03:45,751 - INFO - PRINT: VAL: [11, 6]
2025-04-25 23:03:47,401 - INFO - PRINT: Preparing sequences...
2025-04-25 23:03:48,662 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-25 23:03:53,399 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-25 23:03:57,016 - INFO - PRINT: Undersampled sequence shape: (69436, 800, 7)
2025-04-25 23:03:57,251 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-25 23:03:57,546 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-25 23:03:57,634 - INFO - PRINT: Undersampled sequence shape: (3957, 800, 7)
2025-04-25 23:03:58,214 - INFO - PRINT: Users in train:{9, 10, 14, 15, 24, 28, 31}
2025-04-25 23:03:58,254 - INFO - PRINT: Users in test:{11, 6}
2025-04-25 23:03:58,254 - INFO - PRINT: Number of windows for training:69436
2025-04-25 23:03:58,254 - INFO - PRINT: Number of windows for testing:3957
2025-04-25 23:03:58,500 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-25 23:03:58,500 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-25 23:17:53,593 - INFO - PRINT:     1 | 1.046951 | 0.957678 | 0.8778 | 0.8318 | 814.11
2025-04-25 23:31:42,026 - INFO - PRINT:     2 | 1.023118 | 0.949716 | 0.8779 | 0.8322 | 729.68
2025-04-25 23:45:01,921 - INFO - PRINT:     3 | 1.036197 | 0.961076 | 0.8774 | 0.8314 | 733.19
2025-04-25 23:58:18,650 - INFO - PRINT:     4 | 1.032307 | 0.952436 | 0.8776 | 0.8318 | 735.20
2025-04-26 00:11:33,586 - INFO - PRINT:     5 | 1.020888 | 0.947424 | 0.8778 | 0.8321 | 733.71
2025-04-26 00:24:49,700 - INFO - PRINT:     6 | 1.030070 | 0.951810 | 0.8775 | 0.8316 | 735.39
2025-04-26 00:38:02,105 - INFO - PRINT:     7 | 1.017346 | 0.941599 | 0.8781 | 0.8327 | 730.47
2025-04-26 00:51:14,718 - INFO - PRINT:     8 | 1.012246 | 0.934809 | 0.8783 | 0.8330 | 730.29
2025-04-26 01:04:29,071 - INFO - PRINT:     9 | 1.010772 | 0.933903 | 0.8783 | 0.8331 | 732.48
2025-04-26 01:17:44,954 - INFO - PRINT:    10 | 1.008301 | 0.930622 | 0.8783 | 0.8332 | 732.86
2025-04-26 01:18:04,063 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-26 01:18:04,063 - INFO - PRINT: FOLD: 2
2025-04-26 01:18:04,063 - INFO - PRINT: TRAIN: [10, 11, 6, 31]
2025-04-26 01:18:04,063 - INFO - PRINT: VAL: [9, 14, 15, 24, 28]
2025-04-26 01:18:12,130 - INFO - PRINT: Preparing sequences...
2025-04-26 01:18:12,460 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-26 01:18:13,888 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-26 01:18:14,893 - INFO - PRINT: Undersampled sequence shape: (17705, 800, 7)
2025-04-26 01:18:16,016 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-26 01:18:20,340 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-26 01:18:23,272 - INFO - PRINT: Undersampled sequence shape: (55688, 800, 7)
2025-04-26 01:18:23,514 - INFO - PRINT: Users in train:{10, 11, 6, 31}
2025-04-26 01:18:23,986 - INFO - PRINT: Users in test:{9, 14, 15, 24, 28}
2025-04-26 01:18:23,986 - INFO - PRINT: Number of windows for training:17705
2025-04-26 01:18:23,986 - INFO - PRINT: Number of windows for testing:55688
2025-04-26 01:18:24,806 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-26 01:18:24,806 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-26 01:25:11,162 - INFO - PRINT:     1 | 0.792148 | 0.582264 | 0.5622 | 0.7536 | 193.39
2025-04-26 01:32:03,131 - INFO - PRINT:     2 | 0.831413 | 0.585220 | 0.5713 | 0.7579 | 197.36
2025-04-26 01:38:43,487 - INFO - PRINT:     3 | 0.857268 | 0.587580 | 0.5759 | 0.7600 | 187.73
2025-04-26 01:45:22,489 - INFO - PRINT:     4 | 0.860960 | 0.589179 | 0.5773 | 0.7608 | 187.02
2025-04-26 01:52:01,608 - INFO - PRINT:     5 | 0.870886 | 0.589293 | 0.5792 | 0.7616 | 186.92
2025-04-26 01:58:40,598 - INFO - PRINT:     6 | 0.872757 | 0.588704 | 0.5783 | 0.7613 | 186.89
2025-04-26 02:05:21,185 - INFO - PRINT:     7 | 0.862310 | 0.588687 | 0.5784 | 0.7614 | 187.53
2025-04-26 02:12:01,138 - INFO - PRINT:     8 | 0.877166 | 0.590300 | 0.5806 | 0.7623 | 187.46
2025-04-26 02:18:41,777 - INFO - PRINT:     9 | 0.877520 | 0.589671 | 0.5801 | 0.7621 | 187.08
2025-04-26 02:25:22,127 - INFO - PRINT:    10 | 0.878020 | 0.589310 | 0.5802 | 0.7622 | 187.57
2025-04-26 02:28:54,356 - INFO - PRINT: ----------------------------------------------------------------------------------------------------
2025-04-26 02:28:54,357 - INFO - PRINT: FOLD: 3
2025-04-26 02:28:54,357 - INFO - PRINT: TRAIN: [6, 9, 11, 14, 15, 24, 28]
2025-04-26 02:28:54,357 - INFO - PRINT: VAL: [10, 31]
2025-04-26 02:28:57,803 - INFO - PRINT: Preparing sequences...
2025-04-26 02:28:59,000 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-26 02:29:03,687 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-26 02:29:06,776 - INFO - PRINT: Undersampled sequence shape: (59645, 800, 7)
2025-04-26 02:29:07,127 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-26 02:29:08,037 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-26 02:29:08,522 - INFO - PRINT: Undersampled sequence shape: (13748, 800, 7)
2025-04-26 02:29:09,087 - INFO - PRINT: Users in train:{6, 9, 11, 14, 15, 24, 28}
2025-04-26 02:29:09,200 - INFO - PRINT: Users in test:{10, 31}
2025-04-26 02:29:09,200 - INFO - PRINT: Number of windows for training:59645
2025-04-26 02:29:09,200 - INFO - PRINT: Number of windows for testing:13748
2025-04-26 02:29:09,533 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-26 02:29:09,534 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-26 02:40:32,252 - INFO - PRINT:     1 | 0.691153 | 1.446810 | 0.2175 | 0.4152 | 613.00
2025-04-26 02:51:46,153 - INFO - PRINT:     2 | 0.711612 | 1.484284 | 0.2178 | 0.4157 | 611.21
2025-04-26 03:03:05,800 - INFO - PRINT:     3 | 0.783281 | 1.622324 | 0.2192 | 0.4151 | 613.89
2025-04-26 03:14:28,322 - INFO - PRINT:     4 | 0.815192 | 1.652724 | 0.2191 | 0.4150 | 615.53
2025-04-26 03:27:37,018 - INFO - PRINT:     5 | 0.832158 | 1.667282 | 0.2192 | 0.4150 | 616.42
2025-04-26 03:40:50,210 - INFO - PRINT:     6 | 0.832244 | 1.674929 | 0.2192 | 0.4149 | 623.42
2025-04-26 03:54:07,441 - INFO - PRINT:     7 | 0.833917 | 1.670203 | 0.2192 | 0.4149 | 623.77
2025-04-26 04:05:36,316 - INFO - PRINT:     8 | 0.844154 | 1.685504 | 0.2192 | 0.4149 | 625.03
2025-04-26 04:16:56,569 - INFO - PRINT:     9 | 0.836915 | 1.675713 | 0.2192 | 0.4149 | 615.21
2025-04-26 04:28:15,122 - INFO - PRINT:    10 | 0.843489 | 1.680293 | 0.2192 | 0.4149 | 615.66
2025-04-26 04:29:11,074 - INFO - PRINT: Validation ROC-AUC: 0.4149, PR-AUC: 0.2192, Accuracy: 0.7589, Sober Accuracy: 0.0397, Drunk Accuracy: 0.9931, F1: 0.0748, Threshold: 0.9800
2025-04-26 04:29:11,075 - INFO - PRINT: Updated best config: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 10, 'patience': 5, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250425_230321'}, PR-AUC: 0.2192, Threshold: 0.9800, Epoch: 9.00
2025-04-26 04:29:11,075 - INFO - PRINT: ==================================================
2025-04-26 04:29:11,075 - INFO - PRINT: Final best config: {'device': 'mps', 'window_size': 800, 'ngrams': 7, 'hdc_dimension': 5000, 'batch_size': 64, 'learning_rate': 2, 'epochs': 9, 'patience': 9, 'overlap_ratio': 0.5, 'runtime_log_fld': 'results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250425_230321'}, Final best pr_auc: 0.21917229211681385, Final best threshold: 0.98, Final best epoch: 9.0
2025-04-26 04:29:11,075 - INFO - PRINT: ==================================================
END CROSSVALIDATION
==================================================
2025-04-26 04:29:14,078 - INFO - PRINT: 
BEGIN TRAIN AND EVALUATION FINAL MODEL

2025-04-26 04:29:19,369 - INFO - PRINT: Preparing sequences...
2025-04-26 04:29:20,832 - INFO - PRINT: Preparing sequences with undersampling...
2025-04-26 04:29:26,753 - INFO - PRINT: Balancing sequences via undersampling...
2025-04-26 04:29:30,503 - INFO - PRINT: Undersampled sequence shape: (73393, 800, 7)
2025-04-26 04:29:30,726 - INFO - PRINT: Starting sequence preparation...
2025-04-26 04:29:30,762 - INFO - PRINT: Processing 7 sessions...
2025-04-26 04:29:31,146 - INFO - PRINT: Created 3958 sequences
2025-04-26 04:29:31,146 - INFO - PRINT: Sequences shape: (3958, 800, 7)
2025-04-26 04:29:31,801 - INFO - PRINT: Users in train:{6, 9, 10, 11, 14, 15, 24, 28, 31}
2025-04-26 04:29:31,853 - INFO - PRINT: Users in test:{16, 25, 26}
2025-04-26 04:29:31,853 - INFO - PRINT: Number of windows for training:73393
2025-04-26 04:29:31,853 - INFO - PRINT: Number of windows for testing:3958
2025-04-26 04:29:32,116 - INFO - PRINT: Epoch | Train Loss |  Val Loss  |  Val PR-AUC  |  Val ROC-AUC  |  Epoch Time (s)
2025-04-26 04:29:32,117 - INFO - PRINT: -------------------------------------------------------------------------------------
2025-04-26 04:42:29,354 - INFO - PRINT:     1 | 0.850850 | ------ | ------ | 777.24
2025-04-26 04:55:14,102 - INFO - PRINT:     2 | 0.868706 | ------ | ------ | 764.75
2025-04-26 05:07:57,581 - INFO - PRINT:     3 | 0.871206 | ------ | ------ | 763.48
2025-04-26 05:20:39,070 - INFO - PRINT:     4 | 0.884416 | ------ | ------ | 761.49
2025-04-26 05:33:21,471 - INFO - PRINT:     5 | 0.885179 | ------ | ------ | 762.40
2025-04-26 05:46:05,968 - INFO - PRINT:     6 | 0.905181 | ------ | ------ | 764.49
2025-04-26 05:58:47,325 - INFO - PRINT:     7 | 0.914179 | ------ | ------ | 761.36
2025-04-26 06:11:27,313 - INFO - PRINT:     8 | 0.915635 | ------ | ------ | 759.99
2025-04-26 06:24:06,519 - INFO - PRINT:     9 | 0.922252 | ------ | ------ | 759.20
2025-04-26 06:29:03,581 - INFO - PRINT: Training ROC-AUC: 0.7152, PR-AUC: 0.5541, Accuracy: 0.6594, Sober Accuracy: 0.0332, Drunk Accuracy: 0.9994, F1: 0.0642, Threshold: 0.9800
2025-04-26 06:29:03,584 - INFO - PRINT: Test ROC-AUC: 0.7386, PR-AUC: 0.7626, Accuracy: 0.3891, Sober Accuracy: 0.0000, Drunk Accuracy: 1.0000, F1: 0.0000, Threshold: 0.9800
2025-04-26 06:29:03,693 - INFO - PRINT: Model, predictions, ground truth, and metrics saved in results/HDC_balanced_UNDERSAMPLING_TWEAKED/20250425_230321
2025-04-26 06:29:06,911 - INFO - PRINT: Confusion Matrix:
2025-04-26 06:29:06,911 - INFO - PRINT: [[ 950  590]
 [ 313 2105]]
2025-04-26 06:29:06,926 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x4585b1eb0>
2025-04-26 06:29:07,033 - INFO - PRINT: Class counts in TEST set:
2025-04-26 06:29:07,033 - INFO - PRINT: Label 0: 1540
2025-04-26 06:29:07,033 - INFO - PRINT: Label 1: 2418
2025-04-26 06:29:07,033 - INFO - PRINT: 
Class counts in TRAIN set:
2025-04-26 06:29:07,034 - INFO - PRINT: Label 0: 47562
2025-04-26 06:29:07,035 - INFO - PRINT: Label 1: 25831
2025-04-26 10:17:14,009 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/__init__.py
2025-04-26 10:17:14,009 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/embeddings.py
2025-04-26 10:17:14,009 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/models.py
2025-04-26 10:17:14,028 - INFO - PRINT: /Users/jofremosegui/Desktop/TFG/wearbac_experiments/torchhd/torchhd/__init__.py
